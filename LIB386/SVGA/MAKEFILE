# name the compiler
!ifdef %NT
CPP= $(%WATCOM)\binnt\wpp386
CC = $(%WATCOM)\binnt\wcc386
WL = $(%WATCOM)\binnt\wlib
!else
CPP= $(%WATCOM)\binw\wpp386
CC = $(%WATCOM)\binw\wcc386
WL = $(%WATCOM)\binw\wlib
!endif

!ifdef %MASM
ASM= $(%MASM)\bin\ml
!else
ASM= f:\compil\masm611\bin\ml
!endif

OBJETS1 =	AFFSTR.OBJ	CLIP.OBJ	FONT.OBJ	GPRINTF.OBJ	&
		DIRTYBOX.OBJ	LOGPHYS.OBJ	RECT.OBJ	PLOT.OBJ	&
		SCALEBOX.OBJ	SCALESPT.OBJ	SCALESPI.OBJ			&
		COPYBOX.OBJ	COPYBOXI.OBJ	COPYBOXF.OBJ	COPYBOXM.OBJ	&
		BLITBOX.OBJ	BLITBOXI.OBJ	BLITBOXF.OBJ	BLITBOXM.OBJ	&
		CLRBOX.OBJ	CLRBOXI.OBJ	CLRBOXF.OBJ	CLRBOXM.OBJ	&
		CALCMASK.OBJ	MASK.OBJ	COPYMASK.OBJ	GRAPH.OBJ	&
		CPYBLOCK.OBJ	CPYBLOCI.OBJ	SAVBLOCK.OBJ	RESBLOCK.OBJ	&
		BOX.OBJ		MOUSEDAT.OBJ	INIMOUSE.OBJ			&
		SCREENXY.OBJ	SHADE.OBJ	INITMODE.OBJ


!ifeq BT NT
CFLAGS	= /D_WIN32 /hc /fh=NT
# /DINITGUID
AFLAGS	= /D_WIN32
LIB     = NT_SVG
OBJETS2 =	MOUSEWIN.OBJ	DDRAW.OBJ	PAL.OBJ
!else
CFLAGS	= /D_DOS4GW /hw /fh=DOS
AFLAGS	= /D_DOS4GW
LIB     = DOS_SVG
OBJETS2 =	VESA.OBJ	MOUSEDOS.OBJ					&
		COPYBOV.OBJ	COPYBOVI.OBJ	COPYBOVF.OBJ	COPYBOVM.OBJ	&
		BLITBOV.OBJ	BLITBOVI.OBJ	BLITBOVF.OBJ	BLITBOVM.OBJ	&
		CLEABOV.OBJ	CLEABOVI.OBJ	CLEABOVF.OBJ	CLEABOVM.OBJ
!endif

!ifeq CALL REG
CFLAGS	= $+$(CFLAGS)$-R.PCH /4r
LIB     = $+$(LIB)$-R
AFLAGS = $+$(AFLAGS)$- /DREG_CALL
!else
CFLAGS	= $+$(CFLAGS)$-S.PCH /4s
LIB     = $+$(LIB)$-S
AFLAGS = $+$(AFLAGS)$- /DSTACK_CALL
!endif

CFLAGS = $+$(CFLAGS)$- /D_BUILDING_LIB /d1 /oaxt /ew /zq /s /w3 /mf /DLIB_LOCAL /bt=$(BT) /zp8
LFLAGS = /c /q /b
AFLAGS = $+$(AFLAGS)$- /nologo /Cx /Zm /c /W0 /Sa /Zd /Cp

.SILENT

$(LIB).LIB: $(OBJETS1) $(OBJETS2)
	*$(WL) $(LFLAGS) $(LIB) $?
	PRNTITRE G "$(LIB)"

.cpp.obj:
	PRNTITRE M "$*.CPP"
	$(CPP) $* $(CFLAGS)

.c.obj:
	PRNTITRE M "$*.C"
	$(CC) $* $(CFLAGS)

.asm.obj:
	PRNTITRE M "$*.ASM"
	$(ASM) $(AFLAGS) $*.ASM
